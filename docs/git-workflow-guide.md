# Git 工作流与提交规范指南

## 1. Git 提交流程概述

在我们的项目中，我们遵循特定的 Git 工作流和提交规范，以确保代码历史清晰、可维护。

### 基本 Git 操作流程
```
1. git add .          # 添加更改到暂存区
2. git commit -m "..." # 提交更改
3. git push origin    # 推送到远程仓库
```

## 2. 提交信息规范

### 提交信息格式
我们使用以下格式的提交信息：
```
<type>(<scope>): <subject>
```

其中 `<type>` 是必需的，表示提交的类型，`<scope>` 是可选的，表示影响的范围，`<subject>` 是简短的描述。

### 提交类型 (type)
- `feat`: 新增功能
- `fix`: 修复bug
- `docs`: 文档更新
- `style`: 代码格式调整，不影响逻辑
- `refactor`: 代码重构，既不修复bug也不添加功能
- `test`: 添加或修改测试
- `chore`: 构建过程或辅助工具的变动
- `ci`: CI配置文件和脚本的变动
- `build`: 构建系统或外部依赖的修改
- `revert`: 撤销之前的提交

### 示例
- `feat: 添加用户登录功能`
- `fix: 修复二维码扫描无法正常工作的问题`
- `docs: 更新部署文档`
- `ci: 添加 GitHub Actions 部署配置`
- `build: 添加打包后的文件`

## 3. 分支管理策略

### 主要分支
- `master`: 主分支，用于生产环境的稳定代码

### 功能分支命名规范
- 功能分支: `feature/<功能名称>`
- 修复分支: `fix/<问题描述>`
- 文档分支: `docs/<文档主题>`

### 示例
```
git checkout -b feature/user-authentication
git checkout -b fix/qr-code-scanning
git checkout -b docs/github-actions-guide
```

## 4. 与 GitHub Pages 集成的工作流

### 部署前的检查
在每次推送到 master 分支前，请确保：
1. 本地构建成功：`npm run build`
2. 提交信息遵循规范
3. 代码符合质量标准

### 部署触发机制
1. 推送到 master 分支会自动触发 GitHub Actions
2. Actions 工作流将构建项目并部署到 GitHub Pages
3. 部署完成后，网站将更新

## 5. 常见 Git 操作

### 查看提交历史
```bash
git log --oneline -10    # 显示最近10个提交的简洁信息
git log --graph --oneline --all  # 图形化显示分支历史
```

### 撤销操作
```bash
git reset --soft HEAD~1    # 撤销最后一次提交，保留暂存区的更改
git reset --hard HEAD~1    # 撤销最后一次提交和更改
git checkout .            # 撤销未暂存的更改
```

### 查看差异
```bash
git diff                  # 查看未暂存的更改
git diff --cached         # 查看已暂存但未提交的更改
git diff HEAD~1           # 查看与上一个提交的差异
```

## 6. 提交前检查清单

在提交更改之前，请确认以下事项：

### 代码检查
- [ ] 代码符合项目风格指南
- [ ] 通过了所有测试
- [ ] 没有调试代码或 console.log 语句

### 文档更新
- [ ] 相关文档已更新
- [ ] API 变更已记录

### 构建检查
- [ ] 本地构建成功
- [ ] 预览正常显示

### Git 操作
- [ ] 选择了正确的分支
- [ ] 提交信息遵循规范
- [ ] 提交内容合理分组

## 7. 处理冲突

### 拉取远程更改
```bash
git pull origin master    # 拉取并合并远程更改
```

### 解决冲突
1. 手动编辑冲突文件
2. 使用 `git add` 标记冲突已解决
3. 提交合并结果

## 8. 标签管理

### 创建标签
```bash
git tag -a v1.0.0 -m "Release version 1.0.0"
git push origin v1.0.0
```

## 9. 最佳实践

### 频繁提交
- 小的、逻辑相关的更改
- 清晰的提交信息
- 易于回滚和调试

### 分支策略
- 为每个功能或修复创建单独的分支
- 定期同步主分支的更改
- 及时删除完成的分支

### 代码审查
- 在合并到主分支前进行代码审查
- 使用 PR 描述更改内容和目的
- 邀请团队成员进行审查

## 10. 与 GitHub Actions 集成的注意事项

### 推送前检查
- 确保提交不会破坏构建过程
- 测试在本地环境中正常工作
- 验证依赖项正确更新

### 工作流触发
- 推送到特定分支（通常是 master）
- 提交包含正确的更改（如 workflow 文件）
- 触发器配置正确

## 11. 总结

遵循规范的 Git 工作流有助于保持代码库的健康和清晰的历史记录。结合 GitHub Actions，我们可以实现从代码提交到部署的自动化流程。通过使用标准的提交信息格式和分支命名约定，团队成员可以更好地理解代码的演变过程，也便于自动化工具进行处理和分析。